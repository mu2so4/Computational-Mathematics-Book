\documentclass{article}

\begin{document}
\section{Численное решение обыкновенных дифференциальных уравнений}
В этом разделе будет рассмотрено численное решение ОДУ разностными схемами.
Как говорилось в начале предыдущего раздела, далеко не всегда дифференциальное
уравнение разрешимо аналитическими методами. Здесь будут рассмотрены решения
линейных и нелинейных обыкновеннных дифференциальных уравнений.

\subsection{Сходимость разностных решений к решениям дифференциальных задач}

\begin{define}
	\textbf{Дифференциальная задача} -- задача, которая состоит в
	нахождении такого решения дифференциального уравнения, которое
	удовлетворяет некоторым начальным условиям. Задача Коши относится к
	таковым.
\end{define}

\begin{define}
	\textbf{Порядок сходимости разностного решения} $y_h(x)$ -- это число
	$k$ такое, что при точном решении $y(x)$ верно $y_h(x)=y(x)+O(h^k)$.
\end{define}

\begin{define}
	\textbf{Главный член ошибки} или \textbf{невязки разностного решения}
	-- моном $\Delta(h)$ такой, что $y_h(x)=y(x)+\delta_h(x)+O(h^{k+1})$.
\end{define}

Рассмотрим простейшую задачу Коши.

\begin{example}
\label{eq:simplest_difference_solution_example}
	Решим задачу Коши
	\[F[y(x)]=y'-y=0,\quad y(0)=1,\]
	чьё истинное решение равно $e^x$.

	Расмотрим разностную схему, которая аппроксимирует данное решение:
	\[\frac{y(x+h)-y(x)}{h}-y(x)=0.\]

	Теперь нужно внести туда начальное условие, но решать можно только
	на сетке. Введём разностную сетку
	\[x_j=jh,\;h=const\ll 1,\;j\in\mathbb N\cup\{0\}.\]

	Обозначим $y_j=y(x_j)=y(jh)$. Начальную аппроксимацию зададим точно:
	$y_0=y(0)=1$, и получим из разностной схемы рекуррентную и явную формулы
	членов последовательности $y_j$:
	\[\frac{y_{j+1}-y_j}{h}=y_j,\;y_0=y(0)=1\quad\Rightarrow\quad y_{j+1}=
	(1+h)y_j=(1+h)^{j+1}.\]

	Чего-то не хватает. Мы не можем связать точное решение разностной задачи
	с задачей дифференциальной. Если мы устемим $h$ к 0, то разностное
	решение устремится к единице. Чтобы первое сошлось ко второму, нужно
	записать её не через фиксированный узел $j$, а через фиксированные
	точки пространства:
	\[x_j=jh\quad\Rightarrow\quad y_h(x_j)=(1+h)^\frac{x_j}{h}.\]

	Уберём индекс $j$ у $x$, он теперь ни на что не влияет. Теперь, если
	устремить $h$ к 0, то получится точное решение $y=e^x$.

	Проверим порядок сходимости данного разностного решения. Возьмём наше
	$y_h(x)$ и разложим его по $h$ при $h=0$. Однако это степенная функция
	с переменной $h$ и в основании, и в показателе. В этом нет ничего
	страшного, так как мы можем по основному логарифмическому тождеству
	занести основание степени в знаменатель:
	\[y_h(x)=(1+h)^\frac{x}{h}=e^{\frac{x}{h}\ln(1+h)}.\]

	Для разложения нам нужно вспомнить разложения логарифма и степени:
	\[e^x=1+x+\frac{x^2}{2!}+\frac{x^3}{3!}+O(x^4),\]
	\[\ln(1+h)=h-\frac{h^2}{2}+\frac{h^3}{3}-\frac{h^4}{4}+O(h^5).\]

	И тогда разностное решение разлагается следующим образом:
	\[\frac{x}{h}\ln(1+h)=\frac{x}{h}\big(h-\frac{h^2}{2}
	+O(h^3)\big)=x-\frac{xh}{2}+O(h^2),\]
	\[(1+h)^{x/h}=e^xe^{-\frac{xh}{2}+O(h^2)}=e^x\big(1-\frac{xh}{2}+
	O(h^2)\big)=e^x-\frac{h}{2}xe^x+O(h^2).\]

	Данное разностное решение сходится к точному с первым порядком
	аппроксимации. Главный член невязки
	\[\delta_h(x)=-\frac{h}{2}xe^x.\]
\end{example}

\begin{example}
\label{eq:central_difference_solution_example}
	Решим задачу Коши из примера
	\eqref{eq:simplest_difference_solution_example} при помощи следующей
	компактной разностной схемы
	\[\frac{y(x+h)-y(x)}{h}=\frac{y(x+h)+y(x)}{2}.\]

	Сдвинем её на $-h/2$, чтобы схема была симметричной:
	\[\frac{y(x+\frac{h}{2})-y(x-\frac{h}{2})}{h}=\frac{y(x+\frac{h}{2})+
	y(x-\frac{h}{2})}{2}.\]
	Запишем данную схему на сетке такой, что $y_0=1$:
	\[\frac{y_{j+1}-y_j}{h}=\frac{y_j+y_{j+1}}{2}\Rightarrow
	y_{j+1}=y_j\;\frac{2+h}{2-h}=\Big(\frac{1+h/2}{1-h/2}\Big)^{j+1}.\]

	Сделав замену $j=\frac{x}{h}$, окончательно получаем, что
	\[y_h(x)=\Big(\frac{1+h/2}{1-h/2}\Big)^{x/h}=e^x+\frac{h^2}{12}xe^x+
	O(h^4).\]

	Данное разностное решение имеет второй порядок точности. Вывод
	его главного члена ошибки -- упражнение.
\end{example}

Когда речь идёт об аппроксимации дифференциальных задач, то говорить нужно не
только об аппроксимации схемой аппроксимируемого уравнения, но и об
аппроксимации численно начальными и граничными условиями соответствующих
дифференциальных, и от порядка этой аппроксимации тоже может существенно
зависеть сходимость получаемого численного решения к точному.

\begin{example}\label{eq:spoiled_ds_example}
	Рассмотрим ещё раз пример
	\eqref{eq:central_difference_solution_example}, но пусть теперь
	начальное условие будет не точным, а с аппроксимацией с $n$-м
	порядком:
	\[y(x)=y_0=1+h^n,\quad n\ge 1.\]

	Проделаем тот же путь, что и в предыдущем примере, и получим
	\[y_{j+1}=y_j\;\frac{2+h}{2-h}=\Big(\frac{1+h/2}{1-h/2}\Big)
	^{j+1}(1+h^n).\]

	И окончательно
	\[y_h(x)=\big(e^x+\frac{h^2}{12}xe^x+O(h^4)\big)(1+h^n)=e^x+
	\frac{h^2}{12}xe^x+O(h^4)+h^ne^x+O(h^{2+n}).\]

	Если $n=1$, то мы испортим степень точности разностного решения.
	При $n=2$ мы получим
	\[e^x+h^2e^x\big(1+\frac{x}{12}\big)+O(h^4),\]
	то есть при $n>1$ порядок точности разностного решения не меняется.
\end{example}

\subsubsection{Составная разностная схема}
В некоторых случаях есть необходимость применения разностных схем разных
порядков. Например, тогда, когда у приграничных узлов более низкий порядок
аппроксимации.

\begin{theorem}
	Снижение на единицу порядка схемы в граничных и приграничных узлах
	разностной сетки (в отличие от снижения порядка аппроксимации самого
	граничного условия) не приводит к снижению порядка сходимости
	разностного решения. Большее снижение порядка схемы между тем уже
	снижает порядок аппроксимации разностного решения.
\end{theorem}

\noproof
\newpage

\begin{example}
	Снова изменим разностную схему и начальные условия примера
	\eqref{eq:central_difference_solution_example}. $y_0$ возьмём точно.
	А вот $y_1$ и только его мы зададим иначе, а именно:
	\[\frac{y_1-y_0}{h}=y_0\Rightarrow y_1=(1+h)y_0,\]
	а следующие узлы мы зададим по-старому:
	\[y_{j+1}=y_j\;\frac{1+h/2}{1-h/2}=(1+h)\Big(\frac{1+h/2}{1-h/2}\Big)^j,
	\quad j\ge 1.\]

	И тогда в итоге
	\[y_h(x)=\Big(\frac{1+h/2}{1-h/2}\Big)^{\frac{x}{h}-1}
	(1+h)=e^x+\frac{h^2}{12}(x-6)xe^x+O(h^3).\]

	Схема сохранила второй порядок точности. Вывод главного члена ошибки --
	упражнение.
\end{example}

\subsubsection{Трёхточечные разностные схемы}
Двухточечные разностные схемы не годятся в случае, когда дифференциальное
уравнение второго порядка, потому что не хватает точек. Также дополнительная
точка, очевидно, позволяет повысить порядок аппроксимации разностного решения.

\begin{example}
	Применим к дифференциальному уравнению из примера
	\eqref{eq:simplest_difference_solution_example} трёхточечную
	разностную схему
	\[\frac{y(x+h)-y(x-h)}{2h}=y(x).\]

	Запишем уравнение на сетке:
	\[\frac{y_{j+1}-y_{j-1}}{2h}=y_j,\]
	что перейдёт в уравнение
	\[y_{j+1}-2hy_j-y_{j-1}=0.\]
	Изменим индексы:
	\[y_{j+2}-2hy_{j+1}-y_j=0.\]

	Требуются уже два начальных условия. Первое значение будет точным,
	а второе -- со вторым порядком аппроксимации:
	\[y_0=1,\quad y_1=1+h.\]

	Как решить это уравнение? Да, у нас есть рекуррентная формула, но очень
	хотелось бы получить явную. Поэтому будем искать решение в виде
	\[y_j=\lambda^j,\quad\lambda\ne 0,\]
	после чего уравнение примет вид
	\[\lambda^{j+2}-2h\lambda^{j+1}-\lambda^j=0\Rightarrow
	\lambda^2-2h\lambda-1=0.\]

	Получили характеристическое уравнение. Линейные дифференциальные
	уравнения с постоянными коэффициентами решаются подобным способом.
	Получаем, что
	\[\lambda=h\pm\sqrt{1+h^2}.\]

	Каждому из них соответствует своё частное решение:
	\[y_{j1}=\lambda_1^j=(h-\sqrt{1+h^2})^j,\]
	\[y_{j2}=\lambda_2^j=(h+\sqrt{1+h^2})^j,\]
	линейная комбинаций которых даёт общее решение
	\[y_j=C_1\lambda_1^j+C_2\lambda_2^j.\]

	Чтобы получить решение дифференциальной задачи, удовлетворяющее заданным
	начальным условиям, подставим их в систему уравнений:
	\[
	\begin{cases}
		C_1+C_2=1, \\
		C_1\lambda_1+C_2\lambda_2=1+h. \\
	\end{cases}
	\]

	Её решение -- упражнение.
\end{example}

\begin{example}
	Решим дифференциальное уравнение второго порядка
	\[y''+y=0\]
	с начальными условиями
	\[\;y(0)=0,\quad y'(0)=1.\]

	Нетрудно определить, что точное решение данной задачи Коши
	выглядит как $y=\sin x$. Общее же решение имеет вид
	\[y=C_1e^{-ix}+C_2e^{ix}.\]

	Запишем уравнение на сетке и сразу сформируем характеристическое
	уравнение:
	\[\frac{y_{j+1}-2y_j+y_{j-1}}{h^2}+y_j=0 \quad\Leftrightarrow\quad
	y_{j+2}+(2-h^2)y_{j+1}+y_j=0.\]

	Граничное условие $y_0=y(0)=0$ аппроксимируется точно. А вот из
	$y'(0)=1$ мы можем получить $y_1$ только с первым порядком
	аппроксимации, тут применение составной разностной схемы избежать не
	получится:
	\[\frac{y_1-y_0}{h}=1\Rightarrow y_1=h.\]

	Но эта схема аппроксимирует граничные условия с первым порядком! Если бы
	мы задали $y_1=1+h$, порядок аппроксимации разностного решения снизился
	бы до первого порядка.

	Составим характеристическое уравнение по $y_j=\lambda^j$:
	\[\lambda^2-(2-h^2)\lambda+1=0.\]

	Его решение:
	\[\lambda_1=a+ib,\quad\lambda_2=a-ib,\]
	\[\text{где } a=1-\frac{h^2}{2},\quad b=h\sqrt{1-\frac{h^2}{4}}.\]

	Решение уравнения в общем виде может быть представлено следующим образом:
	\[y_j=C_1\lambda_1^j+C_2\lambda_2^j.\]

	Чтобы было проще возводить число в степень, приведём его к
	тригонометрической форме:
	\[r^2=a^2+b^2=1,\quad\varphi=\arccos{\Big(1-\frac{h^2}{2}\Big)},\]
	и решения характеристического уравнения примут вид:
	\[\lambda_1^j=e^{ij\varphi}=\cos{\varphi j}+i\sin{\varphi j},\]
	\[\lambda_2^j=e^{-ij\varphi}=\cos{\varphi j}-i\sin{\varphi j}.\]

	Комплексное решение означает комплексные коэффициенты. А уравнение
	чисто действительное. Чтобы уйти от комплексных чисел, выразим
	частные решения следующим образом:
	\[\widetilde{y_j^1}=\frac{\lambda_1^j+\lambda_2^j}{2}=\cos{\varphi j},
	\quad\widetilde{y_j^2}=\frac{\lambda_1^j-\lambda_2^j}{2i}=
	\sin{\varphi j}.\]

	Теперь мы можем записать общее решение уравнения в общем виде:
	\[y_j=C_1\lambda_1^j+C_2\lambda_2^j=C_1\cos{\varphi j}+C_2
	\sin{\varphi j},\]
	а начальные условия дают следующее частное решение:
	\[y_j=\frac{h}{\sin\varphi}\sin{\varphi j}.\]

	Окончательно получаем разностное решение
	\[y_h(x)=\frac{h}{\sin\varphi}\sin{\frac{x}{h}\varphi}.\]

	Проверка его аппроксимации -- упражнение.
\end{example}

\subsection{Линейные разностные схемы с постоянными коэффициентами}
Чуть ранее мы рассмотрели более простые случаи подобных разностных схем. Теперь
мы выведем общий алгоритм разрешения разностных схем подобного типа.

\begin{define}\label{eq:linear_difference_scheme}
	\textbf{Линейная разностная схема с постоянными коэффициентами} --
	разностная схема $\Lambda[y(x)]=0$, где
	\[\Lambda[y(x)]=\sum_{m=0}^{n}a_my_{j+m},\quad a_m=const.\]
\end{define}

Решение линейных разностных схем очень похоже на решение линейных
дифференциальных уравнений с постоянными коэффициентами
\[F[y(x)]=\sum_{m=0}^{n}a_my^{(m)}(x)=0,\quad a_n\ne 0,\]
чьё общее решение равно
\[y=\sum_{m=1}^{l}\Big(e^{\lambda_mx}\cdot\sum_{j=0}^{s_m-1}C_{mj}x^j\Big),\]
где $l$ -- число различных корней соответствующего характеристического уравнения
\[P(\lambda)=\sum_{m=0}^{n}a_m\lambda^m=0,\]
$s_i$ -- кратность его $i$ корня, причём $\sum_{m=1}^{l}s_m=n$.

\subsubsection{Случай различных действительных корней}
\begin{theorem}
	Если у характеристического многочлена линейного разностного уравнения
	\eqref{eq:linear_difference_scheme} все корни различны, то его общее
	решение имеет вид
	\[\boxed{y_j=\sum_{m=1}^{n}C_m\lambda_m^j}.\]
\end{theorem}

\begin{proof}
	По аналогии с дифференциальными уравнениями, обозначим за $\lambda_i$
	корни (нули) соответствующего характеристического уравнения, причём
	$\lambda_i\ne 0\quad\forall i\in\overline{1,n}$.

	Поскольку $\lambda_i$ разные и действительные, положим, что решение
	имеет вид
	\[y_j=\sum_{m=1}^{n}C_m\lambda_m^j.\]
	Проверим его правильность, для этого мы подставим в схему $y_j$:
	\[\Lambda_h[y_j]=\sum_{m=0}^{n}a_m\lambda^ {j+m}=\lambda^j\sum_{m=0}^
	{n}a_m\lambda^m=0.\]

	Значит, разностное решение, найденное данным способом, найдено верно.
\end{proof}

\begin{example}\label{eq:4dot_difference_equation}
	Решим 4-точечное разностное уравнение
	\[y_{j+3}-2y_{j+2}-y_{j+1}+2y_j=0,\qquad y_0=0,\;y_1=1,\;y_2=3\]
	и найдём решение, удовлетворяющее граничным условиям.

	Соответствующее характеристическое уравнение $\lambda^3-2\lambda^2-
	\lambda+2=0$ имеет корни $\{-1,1,2\}$, тогда общее решение имеет вид:
	\[y_j=C_1(-1)^j+C_2+C_32^j.\]

	Найдём такое решение, которое удовлетворяет заданному начальному
	условию:
	\[
		\begin{cases}
			C_1+C_2+C_3=0, \\
			-C_1+C_2+2C_3=1, \\
			C_1+C_2+4C_3=3. \\
		\end{cases}
		\Rightarrow
		\begin{cases}
			C_1=0, \\
			C_2=-1, \\
			C_3=1. \\
		\end{cases}
	\]

	Полученное решение задачи Коши:
	\[y_j=2^j-1.\]
\end{example}

\subsubsection{Случай кратных корней}
\begin{lemma}\label{eq:polynomial_power_lowering}
	Если $\mu$ является нулём многочлена $P(x)$, то
	\[(T_1-\mu E)\circ\big(\mu^xP_k(x)\big)=\mu^{x+1}P_{k-1}(j).\]
\end{lemma}

\begin{proof}
	Представим полином как
	\[P_k(x)=\sum_{m=0}^{k}a_mx^m.\]

	Тогда мы сразу получаем
	\[(T_1-\mu E)\circ(\mu^xP_k(x))=\mu^{x+1}\cdot\big(P_k(x+1)-P_k(x)
	\big)=\]
	\[=\mu^{x+1}\sum_{m=0}^{k}a_m\big((x+1)^m-x^m\big)=\mu^{j+1}\sum_{m=1}^
	{k}a_mP_{m-1}(x)=\mu^{x+1}P_{k-1}(x).\]
\end{proof}

\begin{lemma}\label{eq:characteristic_nullicifation}
	Если $\mu$ -- корень кратности $s$ характеристического многочлена
	линейного разностного уравнения \eqref{eq:linear_difference_scheme},
	то $\forall k\in\overline{1,s-1}$ верно
	\[(T-\mu E)^s\circ y_j^k=0,\]
\end{lemma}

\begin{proof}
	Рассмотрим случай $k=s-1$ и применим лемму
	\eqref{eq:polynomial_power_lowering}:
	\[(T-\mu E)^{k+1}\circ(j^k\mu^j)=(T-\mu E)^k\circ\big(P_{k-1}(j)\mu^
	{j+1}\big)=...=\]
	\[=(T-\mu E)\circ(C\cdot\mu^{j+k})=C(\mu^{j+k+1}-\mu^{j+k+1})=0.\]

	При меньшем $k$ зануление произошло бы быстрее.
\end{proof}

\begin{theorem}\label{eq:repeated_characteristics}
	Если характеристический многочлен линейного разностного уравнения
	\eqref{eq:linear_difference_scheme} имеет $l$ различных корней $\mu_i$
	с кратностями $s_i$ соответственно, то общее решение имеет вид
	\[\boxed{y_j=\sum_{i=1}^{l}\big(\mu_i^j\cdot\sum_{m=0}^{s_i-1}C_{im}j^m
	\big)}.\]
\end{theorem}

\begin{proof}
	Введём обозначения операторов сдвига:
	\[T_h\circ y=T\circ y_j=y_{j+1},\quad T^m\circ y_j=y_{j+m}.\]

	Запишем разностное уравнение в операторной форме:
	\[\Lambda[y_j]=P_n(T)\circ y_j, \text{ где } P_n(T)=\sum_{m=0}^{n}a_m
	T^m.\]

	Рассмотрим ноль характеристического уравнения $\mu_i$. Ввиду того, что
	$\mu_i$ является корнем данного многочлена кратности $s_i$, представим
	$P_n(T)$ как
	\[P_n(T)=(T-\mu_i E)^s\circ P_{n-s_i}(T)=P_{n-s_i}(T)\circ(T-\mu_i E)
	^s_i.\]

	Обозначим ту часть $y_j$, которая содержит $\mu_i$ как
	\[y_j^{\mu_i}=\sum_{m=0}^{s_i-1}C_{jm}j^m.\]

	Тогда по лемме \eqref{eq:characteristic_nullicifation}
	\[P_n(T)\circ y_j^{\mu_i}=P_{n-s_i}\circ\big((T-\mu_i E)^s\circ y_j^
	{\mu_i}\big)=0.\]

	С другими $\mu_i$ проделываем аналогичную операцию и получаем, что
	разностное уравнение мы решили правильно.
\end{proof}

\begin{example}
	Решим разностное уравнение
	\[y_{j+3}+7y_{j+2}-16y_{j+1}+12y_j=0.\]

	Корни характеристического уравнения:
	\[\lambda_1=\lambda_2=-2,\quad\lambda_3=-3.\]

	Общее решение:
	\[y_j=(jC_1+C_2)(-2)^j+(-3)^jC_3.\]
\end{example}

\subsubsection{Случай комплексных корней}
Данный случай неприятен тем, что мы хотим такое решение, которое бы содержало
действительные, а не комплексные коэффициенты.

\begin{theorem}\label{eq:complex_roots_de}
	Если характеристический многочлен линейного разностного уравнения
	\eqref{eq:linear_difference_scheme} имеет комплексный корень
	$\mu=\rho e^{i\varphi}$ кратности $s$, то та часть общего решения $y_j$,
	которая образована $\mu$, может иметь вид
	\[\boxed{y_j^\mu=\rho^j\sum_{k=0}^{s-1}j^k\big(C_{k1}\cos{j\varphi}+
	C_{k2}\sin{j\varphi}\big)}.\]
\end{theorem}

\begin{proof}
	Из теоремы \eqref{eq:repeated_characteristics}, мы можем получить
	$y_j^\mu$, не обращая внимания на комплексность $\mu$. Так как $\mu$ --
	ноль характеристического уравнения с действительными коэффициентами, то
	и $\overline{\mu}=\rho e^ {-i\varphi}$ тоже является его нулём, причём с
	той же кратностью $s$.

	Как и прежде, применим невырожденное линейное преобразование. Обозначим
	\[y_j^k=j^k\rho^je^{ij\varphi},\quad \overline{y}_j^k=j^k\rho^je^
	{-ij\varphi},\quad k\in\overline{0,s-1}.\]

	И сделаем следующие подстановки:
	\[\widetilde{y_j^k}=\frac{y_j^k+\overline{y_j^k}}{2}=j^k\rho^j\cos
	{j\varphi},\quad\widehat{y_j^k}=\frac{y_j^k-\overline{y_j^k}}{2i}=j^k
	\rho^j\sin{j\varphi}.\]
\end{proof}

\begin{example}\label{eq:complexes_difference_eq}
	Решим разностное уравнение
	\[y_{j+4}-4y_{j+3}+8y_{j+2}-8y_{j+1}+4y_j=0.\]

	Характеристический полином имеет вид
	\[P(\lambda)=(\lambda^2-2\lambda+2)^2=0.\]

	Получаем пару комплексно-сопряжённых корней каждый двойной кратности:
	\[\lambda_{1,2}=1\pm i.\]

	Представим $\lambda$ в комплексной форме:
	\[\rho=\sqrt{2},\quad\alpha=\pm\frac{\pi}{4}\quad\Rightarrow\quad
	\lambda=\sqrt{2}e^{\pm i\frac{\pi}{4}}.\]

	Окончательно, общее решение имеет вид
	\[y_j=2^{\frac{j}{2}}\Big((C_1j+C_2)\cos{\frac{\pi}{4}j}+(C_3j+C_4)
	\sin{\frac{\pi}{4}j}\Big).\]
\end{example}

\subsection{Устойчивость разностных схем}
Далеко не все разностные схемы подходят для разностных уравнений. Почему?
Потому что может произойти такое, что разностная схема при определённых
условиях может не сойтись к точному решению конкретной дифференциальной
задачи.

Как таковую неустойчивую разностную схему получить довольно сложно (наши методы
к ним точно не приведут), но если очень постараться, то эта задача достижима.
Приведём пример Годунова.

\begin{example}\label{eq:non_stable_scheme}
	Найдём разностное решение следующей задачи Коши:
	\[y'+y=0,\;y(0)=1.\]

	Очевидно, что точное решение $y=e^{-x}$.

	Для решения данной дифференциальной задачи можно использовать один из
	этих разностных операторов, обозначим их:
	\[A=\frac{y_{j+1}-y_{j-1}}{2h},\quad B=\frac{y_{j+1}-y_j}{h}.\]

	Из них Годунов смог сложить следующую разностную схему, которая является
	неустойчивой:
	\[4A-3B+y_j=0.\]

	Зададим начальные условия:
	\[y_0=1,\quad\frac{y_1-y_0}{h}=-y_0\Rightarrow y_1=1-h.\]

	Покажем, что разностная схема неустойчивая.
	Соответствующее разностное уравнение имеет вид
	\[y_{j+2}-(h+3)y_{j+1}+2=0.\]

	Корни характеристического уравнения:
	\[\lambda_1=\frac{3+h-\sqrt{h^2+6h+1}}{2}=1-h+O(h^2),\]
	\[\lambda_2=\frac{3+h+\sqrt{h^2+6h+1}}{2}=2+O(h),\]
	и, соответственно, общее решение
	\[y_j=C_1\lambda_1^j+C_2\lambda_2^j.\]

	Коэффициенты $C_1$ и $C_2$ такие, что удовлетворяют начальным условиям,
	берутся из системы уравнений
	\[
		\begin{cases}
			C_1+C_2=1, \\
			\lambda_1C_1+\lambda_2C_2=1-h. \\
		\end{cases}
	\]

	Коэффициенты приблизительно равны
	\[C_1=1+O(h),\quad C_2=O(h^2).\]

	Теперь мы рассмотрим каждое частное решение поподробней. То, что в своём
	составе имеет $\lambda_1$, является ''хорошим'', так как после
	преобразования в явную формулу мы получим $(1-h)^{x/h}$, что и даёт в
	пределе $e^{-x}$. Но решение при $\lambda_2$ всё портит, потому что оно
	имеет в своём составе двойку:
	\[\lambda_2^j\approx 2^j=2^{x/h},\quad C_2\lambda_2^j=2^{x/h}\cdot
	O(h^2),\]
	при стремлении $h$ к нулю мы получим, что предел данного частного
	решения стремится к бесконечности. Это и делает неустойчивым данное
	разностное решение.
\end{example}

\subsection{Численное решение нелинейных обыкновенных ДУ}
Всё, что мы делали до этого -- это решали на простейших примерах линейные
уравнения, исследовали аппроксимации, их сходимость и устойчивость, однако
помимо линейных уравнений есть также нелинейные уравнения, особенно те, что не
имеют аналитического решения.

В курсе дифференциальных уравнений как-то была доказана следующая важная
теорема:

\begin{theorem}[существования и единственности решения задачи Коши]
	Если в уравнении $y'=f(x,y)$ функция $f(x,y)$ и её частная производная
	$f'_y$ непрерывны в некоторой области $D$, содержащей точку $(x_0,
	y_0)$, то существует единственное решение $y=\varphi(x)$ этого
	уравнения, удовлетворяющее начальному условию $y(x_0)=y_0$.
\end{theorem}

В одномерном случае ($y\in \mathbb R$) мы её можем доказать при помощи
построения ломаных, что превращается в разностную схему. Простейший способ
данного типа называется схемой Эйлера.

\begin{define}
	\textbf{Схема Эйлера} дифференциального уравнения $y'=f(y)$ -- это
	разностная схема
	\[\frac{y_{j+1}-y_j}{h}=f(y_j)\Leftrightarrow y_{j+1}=y_j+hf(y_j),\]
	где
	\[y_j=y(x_j),\quad x_j=jh.\]
\end{define}

\begin{example}
	Решим дифференциальное уравнение и задачу Коши к ней
	\[y'=-y^2,\quad y(0)=1\]
	при шаге $h=0.1$. Точное решение задачи Коши --
	$y(x)=\frac{1}{x+1}$.

	Рекуррентное соотношение при $j>0$ имеет вид $y_{j+1}=y_j-hy_j^2$.
	Отобразим точное и численное решения на графике:\\

	\subfile{graph-euler_method}
\end{example}

\subsubsection{Методы Рунге-Кутты}
К сожалению, схемой Эйлера можно аппроксимировать нелинейное ОДУ только с первым
порядком. Казалось бы: а почему бы не применить компактную разностную схему
\[\frac{y_{j+1}-y_j}{h}=\frac{f(y_{j+1})+f(y_j)}{2}?\]
Да, она аппроксимирует со вторым порядком, и всё бы ничего, если бы мы не были
вынуждены искать $y_j$ через нелинейное уравнение, чего делать не очень хочется.
Да, мы где-то в первой главе изучили численные методы решения подобных уравнений,
но это дополнительные вычислительные затраты для компьютеров. А нельзя ли
повысить порядок аппроксимации иными способами? Конечно же, можно.

\begin{define}
	\textbf{Схема Эйлера с пересчётом} дифференциального уравнения $y'=f(y)$
	-- это разностная схема
	\[\frac{y_{j+1}-y_j}{h}=f(y_{j+\frac{1}{2}}),\quad\text{где }
	y_{j+\frac{1}{2}}=y_j+\frac{h}{2}f(y_j).\]
\end{define}

\begin{theorem}
	Схема Эйлера с пересчётом имеет второй порядок аппроксимации.
\end{theorem}

\begin{proof}
	Введём разностную схему
	\[\Lambda_h[y]=\frac{y_{j+1}-y_j}{h}-f(y_{j+1/2})=0.\]

	При исследовании аппроксимаций нам следует перейти от дискретной схемы к
	схеме от непрерывной переменной:
	\[\Lambda_h[y(x)]=\frac{y(x+h)-y(x)}{h}-f\Big(y\big(x+\frac{h}{2}\big)
	\Big).\]

	Наконец, разложим в ряд Тейлора обе части схемы по $h$ при $h=0$:
	\[\Lambda_h[y(x)]=\cancel{y'}-\cancel{f(y)}+\frac{h}{2}\Big(y''-
	\underset{y''}{\underbrace{f'_y(y)y'}}\Big)+O(h^2)=O(h^2).\]
\end{proof}

Данная схема является разновидностью так называемых схем Рунге-Кутты. Их идея в
том, чтобы использовать аппроксимации без разрастания шаблона схемы, без
решения нелинейных уравнений и получения $y_j$ в явном виде.

\begin{define}
	\textbf{Метод Рунге-Кутты} в общем имеет представление
	\[y_j^1=f_1(h,y_j),\]
	\[y_j^2=f_2(h,y_j,y_j^1),\]
	\[...\]
	\[y_j^n=f_n(h,y_j,y_j^1,...,y_j^{n-1})=y_{j+1},\]
	где $y_j^i$ -- вспомогательные значения, а $f_i$ -- вспомогательные
	функции.
\end{define}

Техника построения таких схем индивидуальна и довольно сложна. Схемы высших
порядков определяются неоднозначно, получаемые схемы могут обладать разными
свойствами. Очень широко используется следующая трёхточечная схема Рунге-Кутты:

\begin{define}
	Одна из трёхточечных схем имеет вид
	\[y_j^1=y_j+hf(y_j),\]
	\[y_j^2=\frac{1}{4}\big(3y_j+y_j^1+hf(y_j^1)\big),\]
	\[y_{j+1}=\frac{1}{3}\big(y_j+2y_j^2+2hf(y_j^2)\big).\]
\end{define}

Доказательство третьего порядка аппроксимации данной схемы -- упражнение.

\end{document}
