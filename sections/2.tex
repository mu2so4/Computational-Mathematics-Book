\documentclass[../main.tex]{subfile}

\begin{document}

\section{Алгебраические методы интерполирования}
Задача интерполирования функции состоит в том, чтобы по известным её значениям
в некоторых точках определить её значения в остальных точках области задания.
Такая задача возникает, например, когда по результатам измерения некоторой
физической величины в одних точках требуется определить её значения в других
точках или когда в целях ускорения вычислений желательно приблизить заданную
функцию более лёгкой в вычислении. Как правило, интерполируют полиномами.

\begin{define}
	Алгебраический полином $P_m(x)=\sum_{k=0}^{m}a_kx^k$ называется
	\textbf{интерполяционным} для функции $f(x)$, заданной на отрезке
	$[a,b]$ по её значениям $f(x_i)$ в $n+1$ попарно различных точках
	$x_i\in[a,b]$ (\textbf{узлах интерполяции}), если
	\[\forall i\in\{0,1,...,n\}\;P_m(x_i)=f(x_i).\]

	\textbf{Задача алгебраической интерполяции} -- построить алгебраический
	полином, который удовлетворял бы данному условию. Далее будем писать
	просто ЗАИ.
\end{define}

Первый вопрос: а какие условия гарантируют существование и единственность
интерполяционного многочлена? Для $m+1$ неизвестного члена полинома мы имеем
$n+1$ условие. Единственность решения математических конечномерных задач
обычно обеспечивается равенством числа неизвестных числу условий. В противном
случае, мы можем либо получить несколько решений, либо не получить их вовсе.

\begin{theorem}[о существовании и единственности интерполяционного многочлена]
\label{eq:polynominal_theorem}
	ЗАИ при $n=m$ имеет единственное решение.
\end{theorem}

\beginproof

	Запишем систему в матричном виде:
	\[
	\begin{pmatrix}
		1	& x_0	& x_0^2	& ...	& x_0^n \\
		1	& x_1	& x_1^2	& ...	& x_1^n \\
		...	& ...	& ...	&\ddots	& ...	\\
		1	& x_n	& x_n^2	& ...	& x_n^n \\
	\end{pmatrix}
	\begin{pmatrix}
		a_0 \\
		a_1 \\
		... \\
		a_n \\
	\end{pmatrix}
	=
	\begin{pmatrix}
		f(x_0)	\\
		f(x_1)	\\
		...	\\
		f(x_n)	\\
	\end{pmatrix}
	\]

	Определитель этой матрицы -- определитель Вандермонда -- не равен нулю,
	так как $x_i\ne x_j$ при $i\ne j$. Это необходимо и достаточно для
	существования и единственности решения.\qed

\subsection{Интерполяционный многочлен Лагранжа}
В теореме \eqref{eq:polynominal_theorem}, мы доказали, что решение ЗАИ
существует, но там не было ни слова о том, как его искать. Считать методом
Крамера -- слишком долго, чтобы не наскучило. Один из способ определить
интерполяционный полином предложил Луи Лагранж.\newline

\begin{theorem}[о представлении в форме Лагранжа]\label{eq:lagrange_polynomial}
	При $n=m$ решение ЗАИ представимо в \textbf{форме Лагранжа}:
	\[P_n(x)=\sum_{k=0}^{n}\frac{\omega(x)}{(x-x_k)\omega'(x_k)}f(x_k),\]
	где
	\[\omega(x)=\prod_{l=0}^{n}(x-x_l)\]
	-- полином степени $n+1$.
\end{theorem}

\beginproof

	Для каждого $k\in\{0,1,...,n\}$ рассмотрим частный случай ЗАИ:
	\[P_{n,k}(x_i)=\delta_{k,i},\;i\in\{0,1,...,n\},\]
	где $\delta_{k,i}$ -- символ Кронекера. Так как полином $P_{n,k}$
	степени $n$ по условию имеет $n$ корней $\{x_0, x_1, ..., x_{k-1},
	x_{k+1}, ..., x_n\}$, он может быть представлен в виде произведения
	мономов:
	\[P_{n,k}(x)=q_k\prod_{\substack{l=0\\ l\neq k}}^{n}(x-x_l),\]
	где $q_k$ берётся из условия $P_{n,k}(x_k)=1$:
	\[q_k=\frac{1}{\prod_{\substack{l=0\\ l\neq k}}^{n}(x-x_l)}.\]
	Обозначив $\omega(x)=\prod_{l=0}^{n}(x-x_l)$, перепишем многочлен:
	\[P_{n,k}(x)=\frac{\omega(x)}{(x-x_k)\omega'(x_k)}f(x_k).\]
	Очевидно, что линейная комбинация
	\[P_n(x)=\sum_{k=0}^{n}P_{n,k}(x)f(x_k)\]
	полиномов -- многочлен степени $n$. А так как $\forall i\in\{0,...,n\}$
	\[P_n(x_i)=\sum_{k=0}^{n}P_{n,k}(x_i)f(x_k)=\sum_{k=0}^{n}\delta_{i,k}
	f(x_k)=f(x_i),\]
	полином является интерполянтом функции $f(x)$.\qed

\begin{example}
	Найдём интерполяционный многочлен Лагранжа функции \\ $f(x)=\cos x +
	\frac{x}{2}$ на отрезке $[0,4]$. Вот список значений:\newline

	\begin{tabular}{|c|c|c|c|}
		\hline
		$x$	& 0	& 2	& 4	\\
		\hline
		$f(x)$	& 1	& 0.584	& 1.346	\\
		\hline
	\end{tabular}

	\[\omega(x)=x(x-2)(x-4).\]

	\[P_2(x)=\omega(x)\big (\frac{1}{8x}-\frac{0.584}{4(x-2)}
	+\frac{1.346}{8(x-4)} \big )=\]
	\[=0.125(x^2-6x+8)-0.146(x^2-4x)+0.168(x^2-2x)=\]
	\[=0.149x^2-0.502x+1.\]

	Найдём значения некоторых внутренних точек:\newline

	\begin{tabular}{|c|c|c|}
		\hline
		$x$     & 1     & 3     \\
		\hline
		$f(x)$  & 1.04	& 0.51	\\
		\hline
		$P_2(x)$& 0.645	& 0.818	\\
		\hline
	\end{tabular}

	И изобразим всё это на графике:\newline

	\begin{tikzpicture} [
		declare function= {
			u(\x) = cos(\x / pi * 180) + \x/2;
			subpolynonominal(\x,\A,\b,\c) = (\x-\b)*(\x-\c) /
				((\A-\b)*(\A-\c)) * u(\A);
			lag(\x,\a,\b,\c) =
				subpolynonominal(\x,\a,\b,\c) +
				subpolynonominal(\x,\b,\c,\a) +
				subpolynonominal(\x,\c,\a,\b);
		},]
		\begin{axis} [
			height=11cm,
			width=16cm,
			xlabel = {$x$},
			ylabel = {$y$},
			axis x line = middle,
			axis y line = middle,
			ymin = -0.3,
			domain = -0.2:4.2,
			ticks = none,
			legend pos = north west ]

			\newcommand*{\varA}{0}
			\newcommand*{\varB}{2}
			\newcommand*{\varC}{4}
			\newcommand*{\queryA}{1}
			\newcommand*{\queryB}{3}
			\pgfmathsetmacro{\fa}{u(\varA)}
			\pgfmathsetmacro{\fb}{u(\varB)}
			\pgfmathsetmacro{\fc}{u(\varC)}
			\pgfmathsetmacro{\Rfirst}{lag(\queryA,\varA,\varB,
				\varC)}
			\pgfmathsetmacro{\Rsecond}{lag(\queryB,\varA,\varB,
				\varC)}
			\pgfmathsetmacro{\RfirstTrue}{u(\queryA)}
			\pgfmathsetmacro{\RsecondTrue}{u(\queryB)}

			\addplot[color=blue, line width=.08cm]{u(x)};
			\addplot[color=red, line width=.04cm]{lag(x,\varA,
				\varB,\varC)};

			\coordinate(A) at 	(\varA,		\fa);
			\coordinate(Ap) at	(\varA,		0);
			\coordinate(B) at 	(\varB,		\fb);
			\node[below](Bp) at	(\varB,		0) {$\varB$};
			\coordinate(C) at 	(\varC,		\fc);
			\node[below](Cp) at	(\varC,		0) {$\varC$};
			\coordinate(Q1) at 	(\queryA,	\Rfirst);
			\node[below](Q1p) at	(\queryA,	0) {$\queryA$};
			\coordinate(Q1true) at	(\queryA,	\RfirstTrue);
			\coordinate(Q2) at 	(\queryB,	\Rsecond);
			\node[below](Q2p) at	(\queryB,	0) {$\queryB$};
			\coordinate(Q2true) at	(\queryB,	\RsecondTrue);

			\addplot[mark=*,only marks, fill=white] (\varA,\fa)
				node[above, pos=1]{};
			\addplot[mark=*,only marks, fill=white] (\varB,\fb)
				node[above, pos=1]{};
			\addplot[mark=*,only marks, fill=white] (\varC,\fc)
				node[above, pos=1]{};
			\addplot[mark=*,only marks, fill=white] (\queryA,\Rfirst)
				node[above, pos=1]{};
			\addplot[mark=*,only marks, fill=white] (\queryA,\RfirstTrue)
				node[above, pos=1]{};
			\addplot[mark=*,only marks, fill=white] (\queryB,\Rsecond)
				node[above, pos=1]{};
			\addplot[mark=*,only marks, fill=white] (\queryB,\RsecondTrue)
				node[above, pos=1]{};
			\addplot[mark=*,only marks, fill=black] (\varA,0)
				node[above, pos=1]{};
			\addplot[mark=*,only marks, fill=black] (\varB,0)
				node[above, pos=1]{};
			\addplot[mark=*,only marks, fill=black] (\varC,0)
				node[above, pos=1]{};
			\addplot[mark=*,only marks, fill=black] (\queryA,0)
				node[above, pos=1]{};
			\addplot[mark=*,only marks, fill=black] (\queryB,0)
				node[above, pos=1]{};

			\draw[thick] (Ap) -- (A)	(Bp) -- (B)
				(Cp) -- (C);
			\draw[dashed] (Q1p) -- (Q1true)	(Q2p) -- (Q2);

			\addlegendentry{$\sin x+\frac{x}{2}$};
			\addlegendentry{$0.149x^2-0.502x+1$};
		\end{axis}
	\end{tikzpicture}
\end{example}

\subsection{Интерполяционный многочлен Ньютона}
Предположим, что мы по $n+1$ узлам интерполяции построили полином Лагранжа
$P_n(x)$ для функции $f(x)$. Затем нам стало известно новое значение
интерполяционной функции при $x_{n+1}$. Вопрос: как быстро мы сможем перестроить
полином под новый узел интерполяции? От полинома $P_n(x)$ построить $P_{n+1}(x)$
нереально сложно, так как из \eqref{eq:lagrange_polynomial} придётся пересчитать
все ''коэффициенты'' вида \[\frac{\omega(x)}{(x-x_k)\omega'(x_k)}.\]

Надо найти новую запись интерполяционного многочлена. Заметьте -- именно запись,
так как по теореме \eqref{eq:polynominal_theorem} интерполяционный полином
единственнен.

Очевидно, что разность $P_{k+1}(x)-P_{k}(x)$ -- полином степени $k+1$. Также
верно то, что для первых $k+1$ интерполяционных узлов $P_{k+1}(x_i)=P_{k}(x_i)$.
Поскольку у полинома степени $k+1$ ровно столько же нулей, верно разложение
\[P_{k+1}(x)-P_{k}(x)=A_{k+1}\prod_{i=0}^{k}(x-x_i),\]
где $A_{k+1}$ -- некоторая константа, которую можно найти из представления
\[\underset{=f(x_{k+1})}{\underbrace{P_{k+1}(x_{k+1})}}-P_{k}(x_{k+1})=A_{k+1}
\prod_{i=0}^{k}(x_{k+1}-x_i)\Rightarrow\]
\[\Rightarrow A_{k+1}=\frac{f(x_{k+1})-P_{k+1}(x_{k+1})}{\prod_{i=0}^{k}(x_{k+1}-x_i)}.\]

Легко получить явную формулу для $A_1$:
\[A_1=\frac{f(x_1)-P_0(x_1)}{x_1-x_0},\]
но $P_0(x_1)=const=f(x_0)$. Таким образом,
\[A_1=\frac{f(x_1)-f(x_0)}{x_1-x_0}.\]

\begin{define}
	\textbf{Разделённая разность $n$-го порядка} функции $f(x)$ на попарно
	разных узлах $x_0,...,x_n$ -- это число
	\[f[x_0,..., x_{n}]=\frac{f[x_1,...,x_n]-f[x_0,...,x_{n-1}]}
	{x_n-x_0},\]
	где $f[y_0,...,y_{n-1}]$ -- разделённая разность $n-1$ порядка, а
	разделённая разность первого порядка равна
	\[\boxed{f[x_0,x_1]=\frac{f(x_1)-f(x_0)}{x_1-x_0}}.\]
\end{define}


\end{document}
