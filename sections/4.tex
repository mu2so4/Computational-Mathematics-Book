\documentclass[../main.tex]{subfile}

\begin{document}

\section{Методы численного дифференцирования}
Как и интегрирование, дифференцирование функции тоже далеко не всегда можно
провести аналитическими методами, например, если функция задана таблично. Также
формулы численного дифференцирования используются для решения дифференциальных
уравнений.

\subsection{Разностные операторы}
\begin{define}
	\textbf{Разностный оператор} $\Lambda_h[y(x)]$ с $k$-ым порядком
	аппроксимации \textbf{аппроксимирует} дифференциальный оператор
	$F[y(x)]$, если для всех достаточно гладких функций $y(x)$ выполняется
	условие
	\[\big|\Lambda_h[y(x)]-F[y(x)]\big|\le O(h^k),\]
	и при этом для некоторых $y(x)$ достигается равенство.
\end{define}

\begin{define}
	Разность $\Lambda_h[y(x)]-F[y(x)]$ называется \textbf{погрешностью}
	разностного оператора.
\end{define}

\begin{define}
	\textbf{Главный член ошибки} или \textbf{невязки} -- первый член
	погрешности разностного оператора, который содержит в себе производную
	$y(x)$ наименьшего порядка. Обозначается как $\Delta_h[y(x)]$.

	Если $\Lambda_h[y(x)]$ аппроксимирует $n$-ую производную функции
	$y(x)\in C^{n+k}$ с $k$-ым порядком аппроксимации, то $\Delta_h[y(x)]=
	c(h)y^{(n+k)}(x)$, где $c(h)$ -- константа, зависящая от $h$.
\end{define}

\begin{define} \label{eq:simpliest_difference_operators}
	Определим простейщие разностные операторы 1-го порядка:
	\[\Lambda_h^+[y(x)]=\frac{y(x+h)-y(x)}{h},\qquad
	\Lambda_h^-[y(x)]=\frac{y(x)-y(x-h)}{h}.\]
\end{define}

\begin{lemma}
	Данные разностные операторы аппроксимируют первую производную для всяких
	$y(x)\in C^3$ с первым порядком аппроксимации.
\end{lemma}

\begin{proof}
	Для определённости рассмотрим $\Lambda_h^+[y(x)]$; для \\
	$\Lambda_h^-[y(x)]$ доказательство аналогичное. Разложим функцию
	$y(x+h)$ в ряд Тейлора по $h$ при $h=0$ с точностью до $h^3$:
	\[f(x+h)=y(x)+hy'(x)+\frac{h^2}{2}y''(x)+\frac{h^3}{6}y'''(x)
	+O(h^4).\]
	Тогда
	\[\Lambda_h^+[y(x)]=y'(x)+\frac{h}{2}y''(x)+\frac{h^2}{6}
	y'''(x)+O(h^3),\]
	\[\Lambda_h[y(x)]-F[y(x)]=\frac{h}{2}y''(x)+\frac
	{h^2}{6}y'''(x)+O(h^3)\Rightarrow \Delta_h[y(x)]=\frac{h}{2}y''(x).\]
\end{proof}

\begin{define}
	Разностные операторы из \eqref{eq:simpliest_difference_operators}
	относятся к \textbf{операторам направленной разности} (вперёд и назад
	соответственно). Из них можно составить оператор \textbf{симметричной}
	разности:
	\[\Lambda_h^*[y(x)]=\frac{\Lambda_h^+[y(x)]+\Lambda_h^-[y(x)]}{2}=
	\frac{y(x+h)-y(x-h)}{2h}.\]
\end{define}

\begin{lemma}
	Данный разностный оператор аппроксимирует первую производную для всяких
	$y(x)\in C^5$ со вторым порядком аппроксимации.
\end{lemma}

\begin{proof}
	Воспользовавшись разложением
	\[y(x\pm h)=y(x)\pm hy'(x)+\frac{h^2}{2!}y''(x)\pm\frac{h^3}{3!}y'''(x)+
	\frac{h^4}{4!}y^{(4)}(x)\pm\frac{h^5}{5!}y^{(5)}(x)+O(h^6),\]
	получим, что
	\[\Lambda_h^*[y(x)]=y'(x)+\frac{h^2}{6}y'''(x)+\frac{h^4}{120}y^{(5)}(x)
	+O(h^5).\]
\end{proof}

\begin{remark}
	Повышение порядка аппроксимации требует повышение гладкости
	аппроксимируемой функции.
\end{remark}

\subsection{Задача аппроксимации производных}
Здесь мы рассмотрим общую задачу аппроксимации производных разностными
операторами.

\begin{define}\label{eq:general_difference_operator}
	Разностный оператор, аппроксимирующий производную $y^{(n)}(x)$, в общем
	виде имеет запись
	\[\boxed{\Lambda_h[y(x)]=\frac{1}{h^n}\sum_{j\in M}a_jy(x+jh)},\]
	где $M$ -- некоторое конечное множество чисел -- \underline{шаблон
	оператора}, -- а \\ $\{a_j\mid j\in M\}$ -- \underline{множество констант}.
\end{define}

\begin{theorem}\label{eq:general_difference_operator_theorem}
	Если для функции $y(x)$, шаблона оператора $M$, а также для множества
	констант $\{a_j\mid j\in M\}$ выполняются следующие условия:
	\begin{enumerate}[noitemsep]
		\item $y(x)\in C^{n+k+1}$,
		\item $\forall m\in\overline{0,n-1}\cup\overline{n+1,n+k-1}
			\quad\mathlarger\sum_{j\in M}a_jj^m=0$, считая при этом
			$0^0=1$,
		\item $\mathlarger\sum_{j\in M}a_jj^n=n!$,
		\item $\mathlarger\sum_{j\in M}a_jj^{n+k}\ne 0$,
	\end{enumerate}
	то разностный оператор \eqref{eq:general_difference_operator}
	аппроксимирует производную $y^{(n)}(x)$ с $k$-ым порядком аппроксимации.
\end{theorem}

\begin{proof}
	Разложим в ряд Тейлора функцию:
	\[y(x+jh)=\sum_{m=0}^{n+k}\frac{(jh)^m}{m!}y^{(m)}(x)+O(h^{n+k+1}).\]

	Подставим это в $\Lambda_h[y(x)]$ и поменяем порядок суммирования:
	\[\Lambda_h[y(x)]=\frac{1}{h^n}\sum_{j\in M}a_j\sum_{m=0}^{n+k}\Big(
	\frac{(jh)^m}{m!}y^{(m)}(x)+O(h^{n+k+1})\Big)=\]
	\[=\sum_{m=0}^{n+k}\Big(\frac{h^{m-n}}{m!}y^{(m)}(x)\sum_{j\in M}
	a_jj^m\Big)+O(h^{k+1})=y^{(m)}(x)+\Delta_h[y(x)]+O(h^{k+1}),\]
	где главный член ошибки имеет вид
	\[\Delta_h[y(x)]=\frac{h^k}{(n+k)!}\Big(\sum_{j\in M}a_jj^{n+k}\Big)
	y^{(n+k)}(x).\]
\end{proof}

\begin{corollary}
	Если в предыдущей теореме известно, что
	\begin{enumerate}[nosep]
		\item $|M|<n+k$, то задача построения разностного оператора не
			имеет решения.
		\item $|M|=n+k$, то задача построения разностного оператора
			 имеет единственное решение.
		\item $|M|>n+k$, то задача построения разностного оператора
			образует $(|M|-n-k)$-параметрическое семейство.
	\end{enumerate}
\end{corollary}

\begin{example}
	Построим разностный оператор $n=1$ производной и с $k=2$ порядком
	аппроксимации на шаблоне $M=\{0,1,2\}$. Составим систему уравнений:
	\begin{equation*}
		\begin{cases}
			a_0+a_1+a_2=0, \\
			0+a_1+2a_2=1, \\
			0+a_1+4a_2=0. \\
		\end{cases}
		\Rightarrow
		\begin{pmatrix}
			a_0 \\
			a_1 \\
			a_2 \\
		\end{pmatrix}
		=
		\begin{pmatrix}
			-1.5 \\
			2 \\
			-0.5 \\
		\end{pmatrix}
	\end{equation*}

	Тогда желаемый разностный оператор имеет вид
	\[\Lambda_h[y(x)]=\frac{-3y(x)+4y(x+h)-y(x+2h)}{2h}.\]

	Найдём его главный член ошибки:
	\[\Delta_h[y(x)]=\frac{h^2}{3!}\big(0a_0+a_1+8a_2\big)y'''(x)=
	-\frac{h^2}{3}y'''(x).\]
\end{example}

\subsection{Симметричные разностные операторы}
Более внимательно рассмотрим симметричные операторы.

\begin{define}\label{eq:central_difference_operator}
	Разностный оператор \eqref{eq:general_difference_operator} является
	\textbf{симметричным}, если $\forall j\in M$ выполняется
	$a_j=(-1)^na_{-j}$, где $n$ -- порядок производной, чья аппроксимация
	ищется.
\end{define}

Из этого определения следует, что шаблон оператора $M$ -- множество,
симметричное относительно нуля

\begin{theorem}
	Если для функции $y(x)$, шаблона оператора $M$, а также для множества
	констант $\{a_j\mid j\in M\}$ выполняются следующие условия:
	\begin{enumerate}[noitemsep]
		\item $y(x)\in C^{n+k+1}$,
		\item $k$ чётное,
		\item Если $n$ чётное, то $a_0+2\sum_{j\in M_+}a_j=0$, где
			$M_+=\{j\in M\mid j>0\}$,
		\item	\begin{equation*}
				\sum_{j\in M_+}a_jj^m=
				\begin{cases}
					0, m\in \{l\in\overline{1,n+k-2}\mid l
						\text{ и }n\text{ одной
						чётности}\}; \\
					\frac{n!}{2}, m=n; \\
					\text{не } 0, m=n+k.
				\end{cases}
			\end{equation*}
	\end{enumerate}
	то симметричный разностный оператор
	\eqref{eq:central_difference_operator} аппроксимирует производную
	$y^{(n)}(x)$ с $k$-ым порядком аппроксимации, а главный член ошибки
	имеет вид
	\[\Delta_h[y(x)]=\frac{2h^k}{(n+k)!}\Big(\sum_{j\in M_+}a_jj^{n+k}\Big)
	y^{(n+k)}(x).\]
\end{theorem}

\begin{proof}
	Из определения следует, что сумма $\mathlarger\sum_{j\in M}a_jj^m$ равна
	нулю при всяких $m$, не совпадающих по чётности с порядком производной
	$n$. Также отсюда вытекает условие аппроксимировать производные с
	чётными порядками аппроксимации, потому что нечётный порядок всегда
	можно увеличить на единицу.

	В случае положительных $m$, совпадающих по чётности с $n$, выражение
	можно сократить в два раза, оставив, например, только положительные $j$.

	Условие 3 гарантирует равенство нулю суммы коэффициентов в случае чётной
	производной. В случае же нечётной производной, все парные коэффициенты
	сократят друг друга, а если $0\in M$, то $a_0=0$.
	
	Тогда мы можем  по теореме \eqref{eq:general_difference_operator_theorem}
	построить необходимый разностный оператор, главный член ошибки которой
	будет иметь заявленную форму независимо от чётности производной.
\end{proof}

\end{document}
